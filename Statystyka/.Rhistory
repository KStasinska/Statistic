hist(df1$`9`, main = paste('P(poiss(0.5)=9) to',round(0.5^9*exp(-0.5)/factorial(9),4)))
df1stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df1stat) <- x
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`1`,0.5^1*exp(-0.5)/factorial(1))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`3`,0.5^3*exp(-0.5)/factorial(3))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`5`,0.5^5*exp(-0.5)/factorial(5))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`7`,0.5^7*exp(-0.5)/factorial(7))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`9`,0.5^9*exp(-0.5)/factorial(9))
df1stat
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df2$`1`, main = paste('P(poiss(1)=1) to',round(1^1*exp(-1)/factorial(1),4)))
hist(df2$`3`, main = paste('P(poiss(1)=3) to',round(1^3*exp(-1)/factorial(3),4)))
hist(df2$`5`, main = paste('P(poiss(1)=5) to',round(1^5*exp(-1)/factorial(5),4)))
hist(df2$`7`, main = paste('P(poiss(1)=7) to',round(1^7*exp(-1)/factorial(7),4)))
hist(df2$`9`, main = paste('P(poiss(1)=9) to',round(1^9*exp(-1)/factorial(9),4)))
df2stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df2stat) <- x
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`1`,1^1*exp(-1)/factorial(1))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`3`,1^3*exp(-1)/factorial(3))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`5`,1^5*exp(-1)/factorial(5))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`7`,1^7*exp(-1)/factorial(7))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`9`,1^9*exp(-1)/factorial(9))
df2stat
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df3$`1`, main = paste('P(poiss(2)=1) to',round(2^1*exp(-2)/factorial(1),4)))
hist(df3$`3`, main = paste('P(poiss(2)=3) to',round(2^3*exp(-2)/factorial(3),4)))
hist(df3$`5`, main = paste('P(poiss(2)=5) to',round(2^5*exp(-2)/factorial(5),4)))
hist(df3$`7`, main = paste('P(poiss(2)=7) to',round(2^7*exp(-2)/factorial(7),4)))
hist(df3$`9`, main = paste('P(poiss(2)=9) to',round(2^9*exp(-2)/factorial(9),4)))
df3stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df3stat) <- x
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`1`,2^1*exp(-2)/factorial(1))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`3`,2^3*exp(-2)/factorial(3))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`5`,2^5*exp(-2)/factorial(5))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`7`,2^7*exp(-2)/factorial(7))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`9`,2^9*exp(-2)/factorial(9))
df3stat
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df4$`1`, main = paste('P(poiss(5)=1) to',round(5^1*exp(-5)/factorial(1),4)))
hist(df4$`3`, main = paste('P(poiss(5)=3) to',round(5^3*exp(-5)/factorial(3),4)))
hist(df4$`5`, main = paste('P(poiss(5)=5) to',round(5^5*exp(-5)/factorial(5),4)))
hist(df4$`7`, main = paste('P(poiss(5)=7) to',round(5^7*exp(-5)/factorial(7),4)))
hist(df4$`9`, main = paste('P(poiss(5)=9) to',round(5^9*exp(-5)/factorial(9),4)))
df4stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df4stat) <- x
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`1`,5^1*exp(-5)/factorial(1))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`3`,5^3*exp(-5)/factorial(3))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`5`,5^5*exp(-5)/factorial(5))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`7`,5^7*exp(-5)/factorial(7))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`9`,5^9*exp(-5)/factorial(9))
df4stat
set.seed(123)
df1 <- data.frame(matrix(ncol = 5, nrow = 0))
df2 <- data.frame(matrix(ncol = 5, nrow = 0))
df3 <- data.frame(matrix(ncol = 5, nrow = 0))
df4 <- data.frame(matrix(ncol = 5, nrow = 0))
x <- c(1,3,5,7,9)
colnames(df1) <- x
colnames(df2) <- x
colnames(df3) <- x
colnames(df4) <- x
for (i in 1:10000){
X1=rpois(100,0.5)
X2=rpois(100,1)
X3=rpois(100,2)
X4=rpois(100,5)
mle1=mean(X1)
mle2=mean(X2)
mle3=mean(X3)
mle4=mean(X4)
wynik1=list()
wynik2=list()
wynik3=list()
wynik4=list()
for (j in c(1,3,5,7,9)){
wynik1=c(wynik1,mle1^j*exp(-mle1)/factorial(j))
wynik2=c(wynik2,mle2^j*exp(-mle2)/factorial(j))
wynik3=c(wynik3,mle3^j*exp(-mle3)/factorial(j))
wynik4=c(wynik4,mle4^j*exp(-mle4)/factorial(j))
}
df1[nrow(df1)+1,] = wynik1
df2[nrow(df2)+1,] = wynik2
df3[nrow(df3)+1,] = wynik3
df4[nrow(df4)+1,] = wynik4
}
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df1$`1`, main = paste('P(poiss(0.5)=1) to',round(0.5^1*exp(-0.5)/factorial(1),4)))
hist(df1$`3`, main = paste('P(poiss(0.5)=3) to',round(0.5^3*exp(-0.5)/factorial(3),4)))
hist(df1$`5`, main = paste('P(poiss(0.5)=5) to',round(0.5^5*exp(-0.5)/factorial(5),4)))
hist(df1$`7`, main = paste('P(poiss(0.5)=7) to',round(0.5^7*exp(-0.5)/factorial(7),4)))
hist(df1$`9`, main = paste('P(poiss(0.5)=9) to',round(0.5^9*exp(-0.5)/factorial(9),4)))
df1stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df1stat) <- x
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`1`,0.5^1*exp(-0.5)/factorial(1))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`3`,0.5^3*exp(-0.5)/factorial(3))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`5`,0.5^5*exp(-0.5)/factorial(5))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`7`,0.5^7*exp(-0.5)/factorial(7))
df1stat[nrow(df1stat)+1,] <- oblicz_statystyki(df1$`9`,0.5^9*exp(-0.5)/factorial(9))
df1stat
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df2$`1`, main = paste('P(poiss(1)=1) to',round(1^1*exp(-1)/factorial(1),4)))
hist(df2$`3`, main = paste('P(poiss(1)=3) to',round(1^3*exp(-1)/factorial(3),4)))
hist(df2$`5`, main = paste('P(poiss(1)=5) to',round(1^5*exp(-1)/factorial(5),4)))
hist(df2$`7`, main = paste('P(poiss(1)=7) to',round(1^7*exp(-1)/factorial(7),4)))
hist(df2$`9`, main = paste('P(poiss(1)=9) to',round(1^9*exp(-1)/factorial(9),4)))
df2stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df2stat) <- x
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`1`,1^1*exp(-1)/factorial(1))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`3`,1^3*exp(-1)/factorial(3))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`5`,1^5*exp(-1)/factorial(5))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`7`,1^7*exp(-1)/factorial(7))
df2stat[nrow(df2stat)+1,] <- oblicz_statystyki(df2$`9`,1^9*exp(-1)/factorial(9))
df2stat
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df3$`1`, main = paste('P(poiss(2)=1) to',round(2^1*exp(-2)/factorial(1),4)))
hist(df3$`3`, main = paste('P(poiss(2)=3) to',round(2^3*exp(-2)/factorial(3),4)))
hist(df3$`5`, main = paste('P(poiss(2)=5) to',round(2^5*exp(-2)/factorial(5),4)))
hist(df3$`7`, main = paste('P(poiss(2)=7) to',round(2^7*exp(-2)/factorial(7),4)))
hist(df3$`9`, main = paste('P(poiss(2)=9) to',round(2^9*exp(-2)/factorial(9),4)))
df3stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df3stat) <- x
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`1`,2^1*exp(-2)/factorial(1))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`3`,2^3*exp(-2)/factorial(3))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`5`,2^5*exp(-2)/factorial(5))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`7`,2^7*exp(-2)/factorial(7))
df3stat[nrow(df3stat)+1,] <- oblicz_statystyki(df3$`9`,2^9*exp(-2)/factorial(9))
df3stat
l=layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
hist(df4$`1`, main = paste('P(poiss(5)=1) to',round(5^1*exp(-5)/factorial(1),4)))
hist(df4$`3`, main = paste('P(poiss(5)=3) to',round(5^3*exp(-5)/factorial(3),4)))
hist(df4$`5`, main = paste('P(poiss(5)=5) to',round(5^5*exp(-5)/factorial(5),4)))
hist(df4$`7`, main = paste('P(poiss(5)=7) to',round(5^7*exp(-5)/factorial(7),4)))
hist(df4$`9`, main = paste('P(poiss(5)=9) to',round(5^9*exp(-5)/factorial(9),4)))
df4stat <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("MSE", "var", "bias")
colnames(df4stat) <- x
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`1`,5^1*exp(-5)/factorial(1))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`3`,5^3*exp(-5)/factorial(3))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`5`,5^5*exp(-5)/factorial(5))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`7`,5^7*exp(-5)/factorial(7))
df4stat[nrow(df4stat)+1,] <- oblicz_statystyki(df4$`9`,5^9*exp(-5)/factorial(9))
df4stat
n=20
set.seed(123)
theta=0.5
fisher1=c()
fisher2=c()
fisher3=c()
fisher4=c()
for (i in 1:10000){
X1=rbeta(20,0.5,1)
X2=rbeta(20,1,1)
X3=rbeta(20,2,1)
X4=rbeta(20,5,1)
mletheta1=-n/sum(log(X1))
mletheta2=-n/sum(log(X2))
mletheta3=-n/sum(log(X3))
mletheta4=-n/sum(log(X4))
fisher1=append(fisher1,1/mletheta1^2)
fisher2=append(fisher2,1/mletheta2^2)
fisher3=append(fisher3,1/mletheta3^2)
fisher4=append(fisher4,1/mletheta4^2)
}
fishermean1=mean(fisher1)
fishermean2=mean(fisher2)
fishermean3=mean(fisher3)
fishermean4=mean(fisher4)
Y1=c()
Y2=c()
Y3=c()
Y4=c()
for (i in 1:10000){
X1=rbeta(20,0.5,1)
X2=rbeta(20,1,1)
X3=rbeta(20,2,1)
X4=rbeta(20,5,1)
mletheta1=-n/sum(log(X1))
mletheta2=-n/sum(log(X2))
mletheta3=-n/sum(log(X3))
mletheta4=-n/sum(log(X4))
y1=sqrt(n*fishermean1)*(mletheta1-theta)
y2=sqrt(n*fishermean2)*(mletheta2-theta)
y3=sqrt(n*fishermean3)*(mletheta3-theta)
y4=sqrt(n*fishermean4)*(mletheta4-theta)
Y1=append(Y1,y1)
Y2=append(Y2,y2)
Y3=append(Y3,y3)
Y4=append(Y4,y4)
}
l=layout(matrix(c(1,2,3,4), nrow = 2, ncol = 2, byrow = TRUE))
hist(Y1)
qqnorm(Y1)
qqline(Y1, col = "steelblue", lwd = 1)
hist(Y2)
qqnorm(Y2)
qqline(Y2, col = "steelblue", lwd = 1)
l=layout(matrix(c(1,2,3,4), nrow = 2, ncol = 2, byrow = TRUE))
hist(Y3)
qqnorm(Y3)
qqline(Y3, col = "steelblue", lwd = 1)
hist(Y4)
qqnorm(Y4)
qqline(Y4, col = "steelblue", lwd = 1)
n=100
set.seed(123)
theta=0.5
fisher1=c()
fisher2=c()
fisher3=c()
fisher4=c()
for (i in 1:10000){
X1=rbeta(100,0.5,1)
X2=rbeta(100,1,1)
X3=rbeta(100,2,1)
X4=rbeta(100,5,1)
mletheta1=-n/sum(log(X1))
mletheta2=-n/sum(log(X2))
mletheta3=-n/sum(log(X3))
mletheta4=-n/sum(log(X4))
fisher1=append(fisher1,1/mletheta1^2)
fisher2=append(fisher2,1/mletheta2^2)
fisher3=append(fisher3,1/mletheta3^2)
fisher4=append(fisher4,1/mletheta4^2)
}
fishermean1=mean(fisher1)
fishermean2=mean(fisher2)
fishermean3=mean(fisher3)
fishermean4=mean(fisher4)
Y1=c()
Y2=c()
Y3=c()
Y4=c()
for (i in 1:10000){
X1=rbeta(100,0.5,1)
X2=rbeta(100,1,1)
X3=rbeta(100,2,1)
X4=rbeta(100,5,1)
mletheta1=-n/sum(log(X1))
mletheta2=-n/sum(log(X2))
mletheta3=-n/sum(log(X3))
mletheta4=-n/sum(log(X4))
y1=sqrt(n*fishermean1)*(mletheta1-theta)
y2=sqrt(n*fishermean2)*(mletheta2-theta)
y3=sqrt(n*fishermean3)*(mletheta3-theta)
y4=sqrt(n*fishermean4)*(mletheta4-theta)
Y1=append(Y1,y1)
Y2=append(Y2,y2)
Y3=append(Y3,y3)
Y4=append(Y4,y4)
}
l=layout(matrix(c(1,2,3,4), nrow = 2, ncol = 2, byrow = TRUE))
hist(Y1)
qqnorm(Y1)
qqline(Y1, col = "steelblue", lwd = 1)
hist(Y2)
qqnorm(Y2)
qqline(Y2, col = "steelblue", lwd = 1)
l=layout(matrix(c(1,2,3,4), nrow = 2, ncol = 2, byrow = TRUE))
hist(Y3)
qqnorm(Y3)
qqline(Y3, col = "steelblue", lwd = 1)
hist(Y4)
qqnorm(Y4)
qqline(Y4, col = "steelblue", lwd = 1)
df <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("theta1", "theta2", "theta3","theta4")
colnames(df) <- x
for (i in 1:10000){
X=rlaplace(20,1,1)
vec=oblicz_estymatory(X,20)
df[nrow(df)+1,] <- vec
}
df=wykresy(df)
y=oblicz_statystyki2(df,1)
y
df <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("theta1", "theta2", "theta3","theta4")
colnames(df) <- x
for (i in 1:10000){
X=rlaplace(20,4,1)
vec=oblicz_estymatory(X,20)
df[nrow(df)+1,] <- vec
}
df=wykresy(df)
y=oblicz_statystyki2(df,4)
y
df <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("theta1", "theta2", "theta3","theta4")
colnames(df) <- x
for (i in 1:10000){
X=rlaplace(20,1,2)
vec=oblicz_estymatory(X,20)
df[nrow(df)+1,] <- vec
}
df=wykresy(df)
y=oblicz_statystyki2(df,1)
y
df <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("theta1", "theta2", "theta3","theta4")
colnames(df) <- x
for (i in 1:10000){
X=rlaplace(100,1,1)
vec=oblicz_estymatory(X,100)
df[nrow(df)+1,] <- vec
}
df=wykresy(df)
y=oblicz_statystyki2(df,1)
y
df <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("theta1", "theta2", "theta3","theta4")
colnames(df) <- x
for (i in 1:10000){
X=rlaplace(100,4,1)
vec=oblicz_estymatory(X,100)
df[nrow(df)+1,] <- vec
}
df=wykresy(df)
y=oblicz_statystyki2(df,4)
y
library(VGAM)
df <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("theta1", "theta2", "theta3","theta4")
colnames(df) <- x
for (i in 1:10000){
X=rlaplace(100,1,2)
vec=oblicz_estymatory(X,100)
df[nrow(df)+1,] <- vec
}
df=wykresy(df)
y=oblicz_statystyki2(df,1)
y
X=c(1,2,3)
sum(sgn(X))
sum(sign(X))
X=c(1,2,3,-6,7)
sum(sign(X))
sum(sign(X))
sum(sign(max(X,0)))
sum(sign(abs(X)))
sum(sign(abs(X)))-sum(sign(X))
sum(X>0)
sum(X<0)
X.length
X.legth()
X.length()
X.size()
X.size
len(X)
X.len
length(X)
set.seed(123)
number=100
library(plotrix)
z=qnorm(0.975,0,1)
f=function(X,mi,sd,n){
flaga=0
l=mean(X)-z*sd/(n)^(0.5)
r=mean(X)+z*sd/(n)^(0.5)
dlugosc=r-l
if (mi>l && mi<r){flaga=1}
return(c(dlugosc,flaga,l,r))
}
df1 <- data.frame(matrix(ncol = 4, nrow = 0))
df2 <- data.frame(matrix(ncol = 4, nrow = 0))
df3 <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("dlugosc","zawiera się","lewy koniec","prawy koniec")
colnames(df1) <- x
colnames(df2) <- x
colnames(df3) <- x
for (i in 1:10000){
X1=rnorm(50,0,1)
X2=rnorm(50,0,2)
X3=rnorm(50,0,3)
df1[nrow(df1)+1,] <- f(X1,0,1,50)
df2[nrow(df2)+1,] <- f(X2,0,2,50)
df3[nrow(df3)+1,] <- f(X3,0,3,50)
}
z=qnorm(0.975,0,1)
f=function(X,p,n){
flaga=0
pval=sum(X>0)/n
var=sqrt(pval(1-pval)/n)
l=pval-z*var
r=pval+z*var
dlugosc=r-l
if (p>l && p<r){flaga=1}
return(c(dlugosc,flaga,l,r))
}
df1 <- data.frame(matrix(ncol = 4, nrow = 0))
df2 <- data.frame(matrix(ncol = 4, nrow = 0))
df3 <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("dlugosc","zawiera się","lewy koniec","prawy koniec")
colnames(df1) <- x
colnames(df2) <- x
colnames(df3) <- x
for (i in 1:10000){
X1=rnorm(50,0,1)
X2=rnorm(50,0,2)
X3=rnorm(50,0,3)
df1[nrow(df1)+1,] <- f(X1,1/2,50)
df2[nrow(df2)+1,] <- f(X2,1/2,50)
df3[nrow(df3)+1,] <- f(X3,1/2,50)
}
f=function(X,p,n){
flaga=0
pval=sum(X>0)/n
var=sqrt(pval*(1-pval)/n)
l=pval-z*var
r=pval+z*var
dlugosc=r-l
if (p>l && p<r){flaga=1}
return(c(dlugosc,flaga,l,r))
}
df1 <- data.frame(matrix(ncol = 4, nrow = 0))
df2 <- data.frame(matrix(ncol = 4, nrow = 0))
df3 <- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("dlugosc","zawiera się","lewy koniec","prawy koniec")
colnames(df1) <- x
colnames(df2) <- x
colnames(df3) <- x
for (i in 1:10000){
X1=rnorm(50,0,1)
X2=rnorm(50,0,2)
X3=rnorm(50,0,3)
df1[nrow(df1)+1,] <- f(X1,1/2,50)
df2[nrow(df2)+1,] <- f(X2,1/2,50)
df3[nrow(df3)+1,] <- f(X3,1/2,50)
}
View(df)
View(df1)
print(paste("(i): ","średnia dlugosc: " ,round(mean(df1$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df1$`zawiera się`)/10000))
print(paste("(ii): ","średnia dlugosc: " ,round(mean(df2$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df2$`zawiera się`)/10000))
print(paste("(iii): ","średnia dlugosc: " ,round(mean(df3$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df3$`zawiera się`)/10000))
print(paste("(ii): ","średnia dlugosc: " ,round(mean(df2$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df2$`zawiera się`)/10000))
print(paste("(i): ","średnia dlugosc: " ,round(mean(df1$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df1$`zawiera się`)/10000))
df1 <- ramkidanych()
ramkidanych=function(){
df<- data.frame(matrix(ncol = 4, nrow = 0))
x <- c("dlugosc","zawiera się","lewy koniec","prawy koniec")
colnames(df) <- x
return(df)
}
df1 <- ramkidanych()
View(df1)
zawieranie(df1,1)
zawieranie=function(df,int){
if(int==1) {print(paste("(i): ","średnia dlugosc: " ,round(mean(df$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df$`zawiera się`)/10000))}
if(int==2) {print(paste("(ii): ","średnia dlugosc: " ,round(mean(df$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df$`zawiera się`)/10000))}
if(int==3) {print(paste("(iii): ","średnia dlugosc: " ,round(mean(df$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df$`zawiera się`)/10000))}
return()
}
zawieranie(df1,1)
zawieranie(df1,1)
a=zawieranie(df1,1)
a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)
wykresy=function(nazwa,value,df){
plot(c(min(df$`lewy koniec`[1:number]-0.1*df$`lewy koniec`[1:number]),max(df$`prawy koniec`[1:number])+0.1*df$`prawy koniec`[1:number]),c(1,number), type="n", xlab=expression(nazwa), ylab=paste(number," przedziałów ufności"), yaxt="n",main="(i)")
segments(df$`lewy koniec`,1:number,df$`prawy koniec`,1:number, col="blue", lwd=1)
abline(v=value,col="red",lwd=1)
}
z=qnorm(0.975,0,1)
f=function(X,p,n){
flaga=0
pval=sum(X>0)/n
var=sqrt(pval*(1-pval)/n)
l=pval-z*var
r=pval+z*var
dlugosc=r-l
if (p>l && p<r){flaga=1}
return(c(dlugosc,flaga,l,r))
}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()
for (i in 1:10000){
X1=rnorm(50,0,1)
X2=rnorm(50,0,2)
X3=rnorm(50,0,3)
df1[nrow(df1)+1,] <- f(X1,1/2,50)
df2[nrow(df2)+1,] <- f(X2,1/2,50)
df3[nrow(df3)+1,] <- f(X3,1/2,50)
}
for (i in 1:10000){
X1=rnorm(50,0,1)
X2=rnorm(50,0,2)
X3=rnorm(50,0,3)
df1[nrow(df1)+1,] <- f(X1,1/2,50)
df2[nrow(df2)+1,] <- f(X2,1/2,50)
df3[nrow(df3)+1,] <- f(X3,1/2,50)
}
a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)
a=zawieranie(df3,3)
wykresy=function(nazwa,value,df){
plot(c(min(df$`lewy koniec`[1:number]-0.1*df$`lewy koniec`[1:number]),max(df$`prawy koniec`[1:number])+0.1*df$`prawy koniec`[1:number]),c(1,number), type="n", xlab=expression(nazwa), ylab=paste(number," przedziałów ufności"), yaxt="n",main="(i)")
segments(df$`lewy koniec`,1:number,df$`prawy koniec`,1:number, col="blue", lwd=1)
abline(v=value,col="red",lwd=1)
}
par(mfrow=c(1, 3))
wykresy(p,1/2,df1)
wykresy(p,1/2,df2)
wykresy(p,1/2,df3)
