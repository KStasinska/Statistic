---
title: "Sprawozdanie 3 Statystyka"
author: "Katarzyna Stasińska"
date: "2023-11"
output: pdf_document
---

```{r,echo=FALSE}
set.seed(123)
number=100
z=qnorm(0.975,0,1)
x1=qchisq(0.975,50)
x2=qchisq(0.025,50)

ramkidanych=function(){
  df<- data.frame(matrix(ncol = 4, nrow = 0))
  x <- c("dlugosc","zawiera się","lewy koniec","prawy koniec")
  colnames(df) <- x
  return(df)
}

zawieranie=function(df,int){
  if(int==1) {print(paste("(i): ","średnia dlugosc: " ,round(mean(df$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df$`zawiera się`)/10000))}
  if(int==2) {print(paste("(ii): ","średnia dlugosc: " ,round(mean(df$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df$`zawiera się`)/10000))}
  if(int==3) {print(paste("(iii): ","średnia dlugosc: " ,round(mean(df$dlugosc),4), "prawdopodobieństwo pokrycia: ",sum(df$`zawiera się`)/10000))}
}

wykresy=function(nazwa,value,df){
  l=min(df$`lewy koniec`[1:number])
  r=max(df$`prawy koniec`[1:number])
  l=l-abs(0.1*l)
  r=r+abs(0.1*r)
  x=max(abs(value-l),abs(r-value))
  plot(c(value-x,value+x),c(1,number), type="n", xlab=nazwa, ylab=paste(number," przedziałów ufności"))
  segments(df$`lewy koniec`,1:number,df$`prawy koniec`,1:number, col="blue", lwd=1)
  abline(v=value,col="red",lwd=1)
}

f2=function(X,mi,sd,n){
  flaga=0
  l=mean(X)-z*sd/(n)^(0.5)
  r=mean(X)+z*sd/(n)^(0.5)
  dlugosc=r-l
  if (mi>l && mi<r){flaga=1}
  return(c(dlugosc,flaga,l,r)) 
}

f4=function(X,mi,n){
  flaga=0
  sd=(sum((X-mean(X))^2)/(n-1))^(1/2) ## nieznana wariancja
  l=mean(X)-z*sd/(n)^(0.5)
  r=mean(X)+z*sd/(n)^(0.5)
  dlugosc=r-l
  if (mi>l && mi<r){flaga=1}
  return(c(dlugosc,flaga,l,r)) 
}

f6=function(X,mi,sd,n){
  flaga=0
  s2=1/n*sum((X-mi)^2)
  l=n*s2/x1
  r=n*s2/x2
  dlugosc=r-l
  if (sd^2>l && sd^2<r){flaga=1}
  return(c(dlugosc,flaga,l,r)) 
}

f8=function(X,sd,n){
  flaga=0
  s2=1/n*sum((X-mean(X))^2)
  l=n*s2/x1
  r=n*s2/x2
  dlugosc=r-l
  if (sd^2>l && sd^2<r){flaga=1}
  return(c(dlugosc,flaga,l,r)) 
}

f10=function(X,p,n){
  flaga=0
  pval=sum(X>0)/n
  var=sqrt(pval*(1-pval)/n)
  l=pval-z*var
  r=pval+z*var
  dlugosc=r-l
  if (p>l && p<r){flaga=1}
  return(c(dlugosc,flaga,l,r)) 
}
```

# Zadanie 1 

NOTATKI BRUDNOPIS

# Zadanie 2

### wyniki eksperymentu a)

```{r setup, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rnorm(50,0,1)
  X2=rnorm(50,0,2)
  X3=rnorm(50,0,3)
  df1[nrow(df1)+1,] <- f2(X1,0,1,50)
  df2[nrow(df2)+1,] <- f2(X2,0,2,50)
  df3[nrow(df3)+1,] <- f2(X3,0,3,50)
}

zawieranie(df1,1)
zawieranie(df2,2)
zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',0,df1)
wykresy('średnia',0,df2)
wykresy('średnia',0,df3)

```

### wyniki eksperymentu b)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rlogis(50,0,1)
  X2=rlogis(50,0,2)
  X3=rlogis(50,0,3)
  df1[nrow(df1)+1,] <- f2(X1,0,sqrt(1^2*pi^2/3),50)
  df2[nrow(df2)+1,] <- f2(X2,0,sqrt(2^2*pi^2/3),50)
  df3[nrow(df3)+1,] <- f2(X3,0,sqrt(3^2*pi^2/3),50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',0,df1)
wykresy('średnia',0,df2)
wykresy('średnia',0,df3)
```

### wyniki eksperymentu c)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

n=50
X1=rcauchy(50,0,1)
X2=rcauchy(50,0,2)
X3=rcauchy(50,0,3)
sd1=(sum((X1-mean(X1))^2)/(n-1))^(1/2)
sd2=(sum((X2-mean(X2))^2)/(n-1))^(1/2)
sd3=(sum((X3-mean(X3))^2)/(n-1))^(1/2)
for (i in 1:10000){
  X1=rcauchy(50,0,1)
  X2=rcauchy(50,0,2)
  X3=rcauchy(50,0,3)
  df1[nrow(df1)+1,] <- f2(X1,0,sd1,50)
  df2[nrow(df2)+1,] <- f2(X2,0,sd2,50)
  df3[nrow(df3)+1,] <- f2(X3,0,sd3,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',0,df1)
wykresy('średnia',0,df2)
wykresy('średnia',0,df3)
```

### wyniki eksperymentu d)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rexp(50,1)
  X2=rexp(50,1/2)
  X3=rexp(50,1/3)
  df1[nrow(df1)+1,] <- f2(X1,1,1,50)
  df2[nrow(df2)+1,] <- f2(X2,2,2,50)
  df3[nrow(df3)+1,] <- f2(X3,3,3,50)
}
a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',1,df1)
wykresy('średnia',2,df2)
wykresy('średnia',3,df3)
```

### wyniki eksperymentu e)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rchisq(50,1)
  X2=rchisq(50,2)
  X3=rchisq(50,3)
  df1[nrow(df1)+1,] <- f2(X1,1,2^(1/2),50)
  df2[nrow(df2)+1,] <- f2(X2,2,4^(1/2),50)
  df3[nrow(df3)+1,] <- f2(X3,3,6^(1/2),50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',1,df1)
wykresy('średnia',2,df2)
wykresy('średnia',3,df3)
```

Wykresy przedstawiają 100 pierwszych wyliczonych przedziałów ufności. Długość przedziałów się nie zmienia. Ich średnia jest równa długości każdego z przedziałów. Prawdopodobieństwo pokrycia nieznanej średniej przez przedział ufności jest bliskie 95%, jedynie w przypadku rozkładu Cauchy'ego wyniki są dalekie od 95%.

# Zadanie 3


# Zadanie 4


### wyniki eksperymentu a)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rnorm(50,0,1)
  X2=rnorm(50,0,2)
  X3=rnorm(50,0,3)
  df1[nrow(df1)+1,] <- f4(X1,0,50)
  df2[nrow(df2)+1,] <- f4(X2,0,50)
  df3[nrow(df3)+1,] <- f4(X3,0,50)
}

zawieranie(df1,1)
zawieranie(df2,2)
zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',0,df1)
wykresy('średnia',0,df2)
wykresy('średnia',0,df3)

```

### wyniki eksperymentu b)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rlogis(50,0,1)
  X2=rlogis(50,0,2)
  X3=rlogis(50,0,3)
  df1[nrow(df1)+1,] <- f4(X1,0,50)
  df2[nrow(df2)+1,] <- f4(X2,0,50)
  df3[nrow(df3)+1,] <- f4(X3,0,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',0,df1)
wykresy('średnia',0,df2)
wykresy('średnia',0,df3)
```

### wyniki eksperymentu c)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rcauchy(50,0,1)
  X2=rcauchy(50,0,2)
  X3=rcauchy(50,0,3)
  df1[nrow(df1)+1,] <- f4(X1,0,50)
  df2[nrow(df2)+1,] <- f4(X2,0,50)
  df3[nrow(df3)+1,] <- f4(X3,0,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',0,df1)
wykresy('średnia',0,df2)
wykresy('średnia',0,df3)
```

### wyniki eksperymentu d)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rexp(50,1)
  X2=rexp(50,1/2)
  X3=rexp(50,1/3)
  df1[nrow(df1)+1,] <- f4(X1,1,50)
  df2[nrow(df2)+1,] <- f4(X2,2,50)
  df3[nrow(df3)+1,] <- f4(X3,3,50)
}
a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',1,df1)
wykresy('średnia',2,df2)
wykresy('średnia',3,df3)
```

### wyniki eksperymentu e)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rchisq(50,1)
  X2=rchisq(50,2)
  X3=rchisq(50,3)
  df1[nrow(df1)+1,] <- f4(X1,1,50)
  df2[nrow(df2)+1,] <- f4(X2,2,50)
  df3[nrow(df3)+1,] <- f4(X3,3,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('średnia',1,df1)
wykresy('średnia',2,df2)
wykresy('średnia',3,df3)
```

# Zadanie 5

# Zadanie 6

### wyniki eksperymentu a)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rnorm(50,0,1)
  X2=rnorm(50,0,2)
  X3=rnorm(50,0,3)
  df1[nrow(df1)+1,] <- f6(X1,0,1,50)
  df2[nrow(df2)+1,] <- f6(X2,0,2,50)
  df3[nrow(df3)+1,] <- f6(X3,0,3,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',1,df1)
wykresy('wariancja',4,df2)
wykresy('wariancja',9,df3)
```

### wyniki eksperymentu b)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rlogis(50,0,1)
  X2=rlogis(50,0,2)
  X3=rlogis(50,0,3)
  df1[nrow(df1)+1,] <- f6(X1,0,sqrt(1^2*pi^2/3),50)
  df2[nrow(df2)+1,] <- f6(X2,0,sqrt(2^2*pi^2/3),50)
  df3[nrow(df3)+1,] <- f6(X3,0,sqrt(3^2*pi^2/3),50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',1^2*pi^2/3,df1)
wykresy('wariancja',2^2*pi^2/3,df2)
wykresy('wariancja',3^2*pi^2/3,df3)
```

### wyniki eksperymentu c)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

n=50
X1=rcauchy(50,0,1)
X2=rcauchy(50,0,2)
X3=rcauchy(50,0,3)
sd1=(sum((X1-mean(X1))^2)/(n-1))^(1/2)
sd2=(sum((X2-mean(X2))^2)/(n-1))^(1/2)
sd3=(sum((X3-mean(X3))^2)/(n-1))^(1/2)
for (i in 1:10000){
  X1=rcauchy(50,0,1)
  X2=rcauchy(50,0,2)
  X3=rcauchy(50,0,3)
  df1[nrow(df1)+1,] <- f6(X1,0,sd1,50)
  df2[nrow(df2)+1,] <- f6(X2,0,sd2,50)
  df3[nrow(df3)+1,] <- f6(X3,0,sd3,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',sd1^2,df1)
wykresy('wariancja',sd2^2,df2)
wykresy('wariancja',sd3^2,df3)
```

### wyniki eksperymentu d)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rexp(50,1)
  X2=rexp(50,1/2)
  X3=rexp(50,1/3)
  df1[nrow(df1)+1,] <- f6(X1,1,1,50)
  df2[nrow(df2)+1,] <- f6(X2,2,2,50)
  df3[nrow(df3)+1,] <- f6(X3,3,3,50)
}
a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',1,df1)
wykresy('wariancja',4,df2)
wykresy('wariancja',9,df3)
```

### wyniki eksperymentu e)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rchisq(50,1)
  X2=rchisq(50,2)
  X3=rchisq(50,3)
  df1[nrow(df1)+1,] <- f6(X1,1,2^(1/2),50)
  df2[nrow(df2)+1,] <- f6(X2,2,4^(1/2),50)
  df3[nrow(df3)+1,] <- f6(X3,3,6^(1/2),50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',2,df1)
wykresy('wariancja',4,df2)
wykresy('wariancja',6,df3)
```

# Zadanie 7

# Zadanie 8

### wyniki eksperymentu a)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rnorm(50,0,1)
  X2=rnorm(50,0,2)
  X3=rnorm(50,0,3)
  df1[nrow(df1)+1,] <- f8(X1,1,50)
  df2[nrow(df2)+1,] <- f8(X2,2,50)
  df3[nrow(df3)+1,] <- f8(X3,3,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',1,df1)
wykresy('wariancja',4,df2)
wykresy('wariancja',9,df3)
```

### wyniki eksperymentu b)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rlogis(50,0,1)
  X2=rlogis(50,0,2)
  X3=rlogis(50,0,3)
  df1[nrow(df1)+1,] <- f8(X1,sqrt(1^2*pi^2/3),50)
  df2[nrow(df2)+1,] <- f8(X2,sqrt(2^2*pi^2/3),50)
  df3[nrow(df3)+1,] <- f8(X3,sqrt(3^2*pi^2/3),50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',1^2*pi^2/3,df1)
wykresy('wariancja',2^2*pi^2/3,df2)
wykresy('wariancja',3^2*pi^2/3,df3)
```

### wyniki eksperymentu c)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

n=50
X1=rcauchy(50,0,1)
X2=rcauchy(50,0,2)
X3=rcauchy(50,0,3)
sd1=(sum((X1-mean(X1))^2)/(n-1))^(1/2)
sd2=(sum((X2-mean(X2))^2)/(n-1))^(1/2)
sd3=(sum((X3-mean(X3))^2)/(n-1))^(1/2)
for (i in 1:10000){
  X1=rcauchy(50,0,1)
  X2=rcauchy(50,0,2)
  X3=rcauchy(50,0,3)
  df1[nrow(df1)+1,] <- f8(X1,sd1,50)
  df2[nrow(df2)+1,] <- f8(X2,sd2,50)
  df3[nrow(df3)+1,] <- f8(X3,sd3,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',sd1^2,df1)
wykresy('wariancja',sd2^2,df2)
wykresy('wariancja',sd3^2,df3)
```

### wyniki eksperymentu d)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rexp(50,1)
  X2=rexp(50,1/2)
  X3=rexp(50,1/3)
  df1[nrow(df1)+1,] <- f8(X1,1,50)
  df2[nrow(df2)+1,] <- f8(X2,2,50)
  df3[nrow(df3)+1,] <- f8(X3,3,50)
}
a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',1,df1)
wykresy('wariancja',4,df2)
wykresy('wariancja',9,df3)
```

### wyniki eksperymentu e)

```{r, echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rchisq(50,1)
  X2=rchisq(50,2)
  X3=rchisq(50,3)
  df1[nrow(df1)+1,] <- f8(X1,2^(1/2),50)
  df2[nrow(df2)+1,] <- f8(X2,4^(1/2),50)
  df3[nrow(df3)+1,] <- f8(X3,6^(1/2),50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('wariancja',2,df1)
wykresy('wariancja',4,df2)
wykresy('wariancja',6,df3)
```

# Zadanie 9

# Zadanie 10

### wyniki eksperymentu a)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rnorm(50,0,1)
  X2=rnorm(50,0,2)
  X3=rnorm(50,0,3)
  df1[nrow(df1)+1,] <- f10(X1,1/2,50)
  df2[nrow(df2)+1,] <- f10(X2,1/2,50)
  df3[nrow(df3)+1,] <- f10(X3,1/2,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('p',1/2,df1)
wykresy('p',1/2,df2)
wykresy('p',1/2,df3)
```

### wyniki eksperymentu b)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rlogis(50,0,1)
  X2=rlogis(50,0,2)
  X3=rlogis(50,0,3)
  df1[nrow(df1)+1,] <- f10(X1,1/2,50)
  df2[nrow(df2)+1,] <- f10(X2,1/2,50)
  df3[nrow(df3)+1,] <- f10(X3,1/2,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('p',1/2,df1)
wykresy('p',1/2,df2)
wykresy('p',1/2,df3)
```

### wyniki eksperymentu c)

```{r,echo=FALSE}
df1 <- ramkidanych()
df2 <- ramkidanych()
df3 <- ramkidanych()

for (i in 1:10000){
  X1=rcauchy(50,0,1)
  X2=rcauchy(50,0,2)
  X3=rcauchy(50,0,3)
  df1[nrow(df1)+1,] <- f10(X1,1/2,50)
  df2[nrow(df2)+1,] <- f10(X2,1/2,50)
  df3[nrow(df3)+1,] <- f10(X3,1/2,50)
}

a=zawieranie(df1,1)
a=zawieranie(df2,2)
a=zawieranie(df3,3)

par(mfrow=c(1, 3))
wykresy('p',1/2,df1)
wykresy('p',1/2,df2)
wykresy('p',1/2,df3)
```

Wykresy przedstawiają 100 pierwszych wyliczonych przedziałów ufności. Długość przedziałów się zmienia, bo zależy od $\hat{p}=\bar{X}$, ale nieznacznie, ponieważ $\hat{p}$ to liczba $X>0$, a powyższe rozkłady są symetryczne, więc wartości $\hat{p}$ są bliskie sobie. Z tego wynika też, że średnie długości przedziałów wyznaczone dla każdego z podpunktów są prawie równe. Prawdopodobieństwo pokrycia nieznanej średniej przez przedział ufności jest bliskie 95%.

# Zadanie 11